document.addEventListener("DOMContentLoaded",function(){let d=0;const u=document.querySelector(".navbar");window.addEventListener("scroll",function(){let e=window.pageYOffset||document.documentElement.scrollTop;e>d&&e>u.offsetHeight?u.classList.add("navbar-hidden"):u.classList.remove("navbar-hidden"),d=e});const n=document.querySelectorAll(".carousel-slide"),v=document.querySelectorAll(".indicator-item"),w=document.querySelectorAll(".description-item");let c=0,k;const b=5e3;function y(e){n.forEach((s,o)=>{s.classList.remove("active"),v[o].classList.remove("active"),w[o].classList.remove("active");const t=v[o].querySelector(".static-progress-bar");t&&(t.style.animation="none",t.offsetHeight,t.style.animation=null)}),n[e].classList.add("active"),v[e].classList.add("active"),w[e].classList.add("active")}function B(){c=(c+1)%n.length,y(c),p()}function p(){clearInterval(k),k=setInterval(B,b)}v.forEach((e,s)=>{e.addEventListener("click",()=>{c=s,y(c),p()})}),w.forEach((e,s)=>{e.addEventListener("click",()=>{c=s,y(c),p()})}),y(c),p();const S=document.getElementById("loginRegisterModal"),j=document.querySelector(".btn-masuk"),T=document.querySelector(".btn-daftar"),D=document.querySelector(".close-button"),L=document.getElementById("loginForm"),E=document.getElementById("registerForm"),A=document.getElementById("showRegister"),F=document.getElementById("showLogin");function q(e){S.classList.add("active"),e==="login"?(L.classList.add("active"),E.classList.remove("active")):e==="register"&&(E.classList.add("active"),L.classList.remove("active"))}function h(){S.classList.remove("active"),document.querySelectorAll(".form-message").forEach(s=>s.remove())}j.addEventListener("click",function(e){e.preventDefault(),q("login")}),T.addEventListener("click",function(e){e.preventDefault(),q("register")}),D.addEventListener("click",h),window.addEventListener("click",function(e){e.target==S&&h()}),A.addEventListener("click",function(e){e.preventDefault(),L.classList.remove("active"),E.classList.add("active"),document.querySelectorAll(".form-message").forEach(o=>o.remove())}),F.addEventListener("click",function(e){e.preventDefault(),E.classList.remove("active"),L.classList.add("active"),document.querySelectorAll(".form-message").forEach(o=>o.remove())}),document.querySelectorAll(".toggle-password").forEach(e=>{e.addEventListener("click",function(){const s=this.dataset.target,o=document.getElementById(s),t=this.querySelector("i");o.type==="password"?(o.type="text",t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye")):(o.type="password",t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash"))})});const g=document.querySelector("#loginForm form"),f=document.querySelector("#registerForm form");function i(e,s,o="error"){let t=e.querySelector(".form-message");t||(t=document.createElement("div"),t.classList.add("form-message"),e.prepend(t)),t.textContent=s,t.style.color=o==="error"?"red":"green",t.style.marginBottom="15px",t.style.textAlign="center"}function I(){const e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):""}g.addEventListener("submit",async function(e){e.preventDefault();const s=this.querySelector(".form-message");s&&s.remove();const o=document.getElementById("loginEmail").value,t=document.getElementById("loginPassword").value;try{const m=await fetch("/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":I()},body:JSON.stringify({email:o,password:t})}),r=await m.json();if(m.ok)i(g,r.message,"success"),r.redirect&&(window.location.href=r.redirect),h();else if(m.status===422&&r.errors){let l="";for(const a in r.errors)l+=r.errors[a].join(", ")+`
`;i(g,l)}else i(g,r.message||"Terjadi kesalahan saat login.")}catch(m){console.error("Error saat login:",m),i(g,"Terjadi kesalahan jaringan atau server.")}}),f.addEventListener("submit",async function(e){e.preventDefault();const s=this.querySelector(".form-message");s&&s.remove();const o=document.getElementById("registerName").value,t=document.getElementById("registerEmail").value,m=document.getElementById("registerPassword").value,r=document.getElementById("confirmPassword").value;try{const l=await fetch("/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":I()},body:JSON.stringify({name:o,email:t,password:m,password_confirmation:r})}),a=await l.json();if(l.ok)i(f,a.message,"success"),a.redirect&&(window.location.href=a.redirect),h();else if(l.status===422&&a.errors){let M="";for(const C in a.errors)M+=a.errors[C].join(", ")+`
`;i(f,M)}else i(f,a.message||"Terjadi kesalahan saat pendaftaran.")}catch(l){console.error("Error saat pendaftaran:",l),i(f,"Terjadi kesalahan jaringan atau server.")}})});document.addEventListener("DOMContentLoaded",function(){const d=document.querySelector(".profile-dropdown");document.querySelector(".dropdown-menu"),d.addEventListener("click",function(n){n.stopPropagation(),d.classList.toggle("active")}),window.addEventListener("click",function(n){d.contains(n.target)||d.classList.remove("active")});const u=document.getElementById("websiteLogo");u&&u.addEventListener("click",function(n){n.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})});
